<ion-header class="ion-no-border" mode="ios">

  <ion-toolbar>

    <ion-buttons slot="start">

      <ion-menu-button color="dark">

        <ion-icon name="menu-outline"></ion-icon>

      </ion-menu-button>

    </ion-buttons>

    <img class="logo" src="../../../assets/images/logo.png">

    <ion-buttons slot="end">

      <ion-toggle color="primary" (ionChange)="changeStatus($event)" [checked]="company?.is_open == 1"></ion-toggle>

    </ion-buttons>

  </ion-toolbar>

</ion-header>

<ion-content mode="ios">

  <ion-refresher mode="md" slot="fixed" (ionRefresh)="refresh($event)">

    <ion-refresher-content></ion-refresher-content>

  </ion-refresher>

  <ion-list class="animated bounceInUp">

    <ion-card class="ion-padding balance" button="true" (click)="wallet()" *ngIf="company?.accept_payment_app">

      <ion-card-subtitle>Pagamentos Online</ion-card-subtitle>

      <ion-card-title>Carteira</ion-card-title>
      
      <h6>{{ company?.balance_available | money }}</h6>

    </ion-card>

    <ion-card *ngIf="company">

      <ion-card-header>

        <ion-card-title>Resumo</ion-card-title>

      </ion-card-header>

      <ion-card-content>

        <ion-list>

          <ion-item lines="full">

            <h6>Status</h6>

            <h6 class="ion-text-right">

              <ion-badge color="success" *ngIf="company?.is_open == 1">Aberto</ion-badge>

              <ion-badge color="medium" *ngIf="company?.is_open == 0">Fechado</ion-badge>

            </h6>

          </ion-item>

          <ion-item lines="full">

            <h6>Valor mínimo</h6>

            <h6 class="ion-text-right">{{ company?.min_value | money }}</h6>

          </ion-item>

          <ion-item lines="full">

            <h6>

              Tempo de espera

            </h6>

            <h6 class="ion-text-right">{{ company?.waiting_time }} min</h6>

          </ion-item>

          <ion-item lines="none">

            <h6>Avaliação</h6>

            <h6 class="ion-text-right" *ngIf="company?.feedback">

              {{ company.feedback.replace('.', ',') }}

              <ion-icon name="star"></ion-icon>

            </h6>

            <h6 class="ion-text-right" *ngIf="!company?.feedback">

              0 <ion-icon name="star" color="light"></ion-icon>

            </h6>

          </ion-item>

        </ion-list>

      </ion-card-content>

    </ion-card>

    <ion-card *ngIf="performance?.months || performance?.days">

      <ion-card-header>

        <ion-card-title>Desempenho</ion-card-title>
        
        <ion-segment (ionChange)="segmentChanged($event)" value="{{ segment }}" *ngIf="performance?.months && performance?.days">

          <ion-segment-button value="1">

            <ion-label>Últimos dias</ion-label>

          </ion-segment-button>

          <ion-segment-button value="2">

            <ion-label>Últimos meses</ion-label>

          </ion-segment-button>

        </ion-segment>

      </ion-card-header>

      <ion-card-content class="ion-no-padding">

        <ngx-charts-bar-vertical
          [view]="view"
          [scheme]="colorScheme"
          [legend]="false"
          [showXAxisLabel]="true"
          [xAxis]="true"
          [results]="performance?.days"
          [gradient]="true"
          [roundEdges]="false"
          [showGridLines]="false"
          [xAxisTickFormatting]="formatDay"
          *ngIf="performance?.days && segment == 1">

          <ng-template #tooltipTemplate let-model="model">

            <h6>{{ model.value | money }}</h6>

            <p>{{ formatDay(model.name) }}</p>

          </ng-template>

        </ngx-charts-bar-vertical>

        <ngx-charts-bar-vertical
          [view]="view"
          [scheme]="colorScheme"
          [legend]="false"
          [showXAxisLabel]="true"
          [xAxis]="true"
          [results]="performance?.months"
          [gradient]="true"
          [roundEdges]="false"
          [showGridLines]="false"
          [xAxisTickFormatting]="formatMonth"
          *ngIf="performance?.months && segment == 2">

          <ng-template #tooltipTemplate let-model="model">

            <h6>{{ model.value | money }}</h6>

            <p>{{ formatMonth(model.name) }}</p>

          </ng-template>

        </ngx-charts-bar-vertical>

      </ion-card-content>

    </ion-card>

  </ion-list>

</ion-content>